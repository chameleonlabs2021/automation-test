const { InstallmentsGenerator, MigrationInstallmentsGenerator } = require('../lib/components/InstallmentsGenerators/index.js');
const { DateCalc } = require('../lib/utils/DateCalc.js');

const global = globalThis;
// To test script - run `node installments.js`
// const payload = JSON.parse('{"charges":[{"amount":"-3.00","amountCurrency":"USD","category":"new","chargeId":"1_premium_fa96934f-5694-4e47-bd7b-811b6c426e2f","coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","isNew":true,"originalAmount":"-3.00","perilCharacteristicsLocator":"fa96934f-5694-4e47-bd7b-811b6c426e2f","perilLocator":"040ddac6-7d66-4a5d-ad9c-97d982e1f06e","perilName":"canine_liability_exclusion_for_select_breeds","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"14.00","amountCurrency":"USD","category":"new","chargeId":"2_premium_ef97c585-f307-4414-ac51-714ea911b315","coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","isNew":true,"originalAmount":"14.00","perilCharacteristicsLocator":"ef97c585-f307-4414-ac51-714ea911b315","perilLocator":"af693279-3e7e-49e1-b689-ec7b258ac208","perilName":"coverage_e_personal_liability","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"8.00","amountCurrency":"USD","category":"new","chargeId":"3_premium_7c5953a0-b2ce-48c6-af39-cc750263946d","coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","isNew":true,"originalAmount":"8.00","perilCharacteristicsLocator":"7c5953a0-b2ce-48c6-af39-cc750263946d","perilLocator":"9ccccf5f-e6cf-433c-bbb0-d9091140c0d3","perilName":"coverage_f_medical_payments","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"84.00","amountCurrency":"USD","category":"new","chargeId":"4_premium_af6d7253-3bbb-460e-9d6a-536dd4365fc8","coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","isNew":true,"originalAmount":"84.00","perilCharacteristicsLocator":"af6d7253-3bbb-460e-9d6a-536dd4365fc8","perilLocator":"e689bc6d-025b-42e3-bb6d-55ac3c78e207","perilName":"coverage_c_contents","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"0.00","amountCurrency":"USD","category":"new","chargeId":"5_premium_eb4fcd8b-2042-476a-916e-1a4f6ebf5e66","coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","isNew":true,"originalAmount":"0.00","perilCharacteristicsLocator":"eb4fcd8b-2042-476a-916e-1a4f6ebf5e66","perilLocator":"166dfe3c-a789-4d76-854f-6e905e2f9999","perilName":"coverage_d_loss_of_use","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"12.00","amountCurrency":"USD","category":"new","chargeId":"6_premium_d94c9c30-89b4-4653-ad45-ca094ca11b41","coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","isNew":true,"originalAmount":"12.00","perilCharacteristicsLocator":"d94c9c30-89b4-4653-ad45-ca094ca11b41","perilLocator":"14ed2b8d-43eb-4c6f-911f-53dff56c7f8a","perilName":"limited_bed_bug_cover","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"30.00","amountCurrency":"USD","category":"new","chargeId":"7_premium_3fd237c9-f094-45f6-9c14-8a1c15758f61","coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","isNew":true,"originalAmount":"30.00","perilCharacteristicsLocator":"3fd237c9-f094-45f6-9c14-8a1c15758f61","perilLocator":"3e098176-a700-49cc-b196-7f1c8e435b73","perilName":"personal_electronics_blanket","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"29.00","amountCurrency":"USD","category":"new","chargeId":"8_premium_385587f8-da5c-46c3-9348-b079ebdfbb96","coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","isNew":true,"originalAmount":"29.00","perilCharacteristicsLocator":"385587f8-da5c-46c3-9348-b079ebdfbb96","perilLocator":"123f1878-6e5c-4819-a840-85939856e778","perilName":"replacement_cost","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","previouslyInvoicedAmount":"0","type":"premium"}],"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","defaultPaymentTerms":{"amount":"7","unit":"day"},"oldPaymentScheduleName":"monthly","operation":"newBusiness","paymentScheduleName":"monthly","plannedInvoices":[],"policy":{"characteristics":[{"createdTimestamp":"1694813273079","endTimestamp":"1726358399999","fieldGroupsByLocator":{"fa34599c-fa64-436d-891a-187299546815":{"address_city":["San Marcos"],"address_line_1":["601 University Dr"],"address_state":["TX"],"address_zip":["78666"],"iso_protection_class":["2"],"iso_territory_code":["13"]}},"fieldValues":{"all_peril_deductible":["250"],"auto_renewal_status":["renew"],"building_code_effectiveness_grade":["ungraded"],"building_details":["fa34599c-fa64-436d-891a-187299546815"],"construction_type":["frame"],"custom_policy_number":["test123456"],"has_restricted_dog_breed":["no"],"number_of_units_in_building":["three units"],"number_significant_others":["0"],"policy_term":["1"],"prior_claims":["0"],"protective_devices":["na"],"superior_construction":["no"]},"grossPremium":"174.00","grossTaxes":"0.00","locator":"65b6217e-f633-4490-84c1-bdd097a5a813","mediaByLocator":{},"policyEndTimestamp":"1726358399999","policyLocator":"100017368","policyStartTimestamp":"1694736000000","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","startTimestamp":"1694736000000","taxGroups":[],"updatedTimestamp":"1694813759579"}],"configVersion":"34","createdTimestamp":"1694813273079","currency":"USD","displayId":"100017368","documents":[],"effectiveContractEndTimestamp":"1726358399999","exposures":[{"characteristics":[{"createdTimestamp":"1694813659634","endTimestamp":"1726358399999","exposureLocator":"751eeff0-3119-4872-895e-8aef55a298bd","fieldGroupsByLocator":{},"fieldValues":{},"locator":"b4b7b328-883b-4dce-80b6-b3bda00f5f24","mediaByLocator":{},"policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","startTimestamp":"1694736000000","updatedTimestamp":"1694813659634"}],"createdTimestamp":"1694813659634","displayId":"100017400","locator":"751eeff0-3119-4872-895e-8aef55a298bd","name":"liability","perils":[{"characteristics":[{"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","createdTimestamp":"1694813659634","exposureCharacteristicsLocator":"b4b7b328-883b-4dce-80b6-b3bda00f5f24","fieldGroupsByLocator":{},"fieldValues":{},"locator":"fa96934f-5694-4e47-bd7b-811b6c426e2f","mediaByLocator":{},"monthPremium":"-0.2500000","perilLocator":"040ddac6-7d66-4a5d-ad9c-97d982e1f06e","policyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premium":"-3.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"createdTimestamp":"1694813659634","displayId":"100017402","exposureLocator":"751eeff0-3119-4872-895e-8aef55a298bd","locator":"040ddac6-7d66-4a5d-ad9c-97d982e1f06e","name":"canine_liability_exclusion_for_select_breeds","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","renewalGroup":"040ddac6-7d66-4a5d-ad9c-97d982e1f06e","updatedTimestamp":"1694813659634"},{"characteristics":[{"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","createdTimestamp":"1694813659634","exposureCharacteristicsLocator":"b4b7b328-883b-4dce-80b6-b3bda00f5f24","fieldGroupsByLocator":{},"fieldValues":{"coverage_e_personal_liability_limit":["300000"]},"locator":"ef97c585-f307-4414-ac51-714ea911b315","mediaByLocator":{},"monthPremium":"1.1666667","perilLocator":"af693279-3e7e-49e1-b689-ec7b258ac208","policyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premium":"14.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"createdTimestamp":"1694813659634","displayId":"100017404","exposureLocator":"751eeff0-3119-4872-895e-8aef55a298bd","locator":"af693279-3e7e-49e1-b689-ec7b258ac208","name":"coverage_e_personal_liability","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","renewalGroup":"af693279-3e7e-49e1-b689-ec7b258ac208","updatedTimestamp":"1694813700605"},{"characteristics":[{"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","createdTimestamp":"1694813659634","exposureCharacteristicsLocator":"b4b7b328-883b-4dce-80b6-b3bda00f5f24","fieldGroupsByLocator":{},"fieldValues":{"coverage_f_medical_payments_limit":["3000"]},"locator":"7c5953a0-b2ce-48c6-af39-cc750263946d","mediaByLocator":{},"monthPremium":"0.6666667","perilLocator":"9ccccf5f-e6cf-433c-bbb0-d9091140c0d3","policyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premium":"8.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"createdTimestamp":"1694813659634","displayId":"100017406","exposureLocator":"751eeff0-3119-4872-895e-8aef55a298bd","locator":"9ccccf5f-e6cf-433c-bbb0-d9091140c0d3","name":"coverage_f_medical_payments","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","renewalGroup":"9ccccf5f-e6cf-433c-bbb0-d9091140c0d3","updatedTimestamp":"1694813700605"}],"policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813739203"},{"characteristics":[{"createdTimestamp":"1694813700605","endTimestamp":"1726358399999","exposureLocator":"4fff9ab6-3df2-45ca-840c-6bcf56fbd4b1","fieldGroupsByLocator":{},"fieldValues":{},"locator":"6f0680d9-951e-4621-9f4a-1351df758fa3","mediaByLocator":{},"policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","startTimestamp":"1694736000000","updatedTimestamp":"1694813700605"}],"createdTimestamp":"1694813700605","displayId":"100017382","locator":"4fff9ab6-3df2-45ca-840c-6bcf56fbd4b1","name":"property","perils":[{"characteristics":[{"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","createdTimestamp":"1694813700605","exposureCharacteristicsLocator":"6f0680d9-951e-4621-9f4a-1351df758fa3","fieldGroupsByLocator":{},"fieldValues":{"coverage_c_contents_limit":["15000"]},"locator":"af6d7253-3bbb-460e-9d6a-536dd4365fc8","mediaByLocator":{},"monthPremium":"7.0000000","perilLocator":"e689bc6d-025b-42e3-bb6d-55ac3c78e207","policyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premium":"84.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"createdTimestamp":"1694813700605","displayId":"100017384","exposureLocator":"4fff9ab6-3df2-45ca-840c-6bcf56fbd4b1","locator":"e689bc6d-025b-42e3-bb6d-55ac3c78e207","name":"coverage_c_contents","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","renewalGroup":"e689bc6d-025b-42e3-bb6d-55ac3c78e207","updatedTimestamp":"1694813725378"},{"characteristics":[{"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","createdTimestamp":"1694813700605","exposureCharacteristicsLocator":"6f0680d9-951e-4621-9f4a-1351df758fa3","fieldGroupsByLocator":{},"fieldValues":{"coverage_d_loss_of_use_limit":["5000"]},"locator":"eb4fcd8b-2042-476a-916e-1a4f6ebf5e66","mediaByLocator":{},"monthPremium":"0.0000000","perilLocator":"166dfe3c-a789-4d76-854f-6e905e2f9999","policyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premium":"0.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"createdTimestamp":"1694813700605","displayId":"100017386","exposureLocator":"4fff9ab6-3df2-45ca-840c-6bcf56fbd4b1","locator":"166dfe3c-a789-4d76-854f-6e905e2f9999","name":"coverage_d_loss_of_use","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","renewalGroup":"166dfe3c-a789-4d76-854f-6e905e2f9999","updatedTimestamp":"1694813725378"}],"policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813725378"},{"characteristics":[{"createdTimestamp":"1694813725378","endTimestamp":"1726358399999","exposureLocator":"ce9d8ae2-3f3b-4aa4-aca7-22ada0463b22","fieldGroupsByLocator":{},"fieldValues":{},"locator":"3cbfbb94-39a6-4e30-aca4-67dd0efa940d","mediaByLocator":{},"policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","startTimestamp":"1694736000000","updatedTimestamp":"1694813725378"}],"createdTimestamp":"1694813725378","displayId":"100017398","locator":"ce9d8ae2-3f3b-4aa4-aca7-22ada0463b22","name":"default_add_on_coverages","perils":[{"characteristics":[{"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","createdTimestamp":"1694813725378","exposureCharacteristicsLocator":"3cbfbb94-39a6-4e30-aca4-67dd0efa940d","fieldGroupsByLocator":{},"fieldValues":{"limited_bed_bug_cover_limit":["300"]},"locator":"d94c9c30-89b4-4653-ad45-ca094ca11b41","mediaByLocator":{},"monthPremium":"1.0000000","perilLocator":"14ed2b8d-43eb-4c6f-911f-53dff56c7f8a","policyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premium":"12.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"createdTimestamp":"1694813725378","displayId":"100017502","exposureLocator":"ce9d8ae2-3f3b-4aa4-aca7-22ada0463b22","locator":"14ed2b8d-43eb-4c6f-911f-53dff56c7f8a","name":"limited_bed_bug_cover","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","renewalGroup":"14ed2b8d-43eb-4c6f-911f-53dff56c7f8a","updatedTimestamp":"1694813756134"},{"characteristics":[{"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","createdTimestamp":"1694813725378","exposureCharacteristicsLocator":"3cbfbb94-39a6-4e30-aca4-67dd0efa940d","fieldGroupsByLocator":{},"fieldValues":{"personal_electronics_blanket_limit":["1000"]},"locator":"3fd237c9-f094-45f6-9c14-8a1c15758f61","mediaByLocator":{},"monthPremium":"2.5000000","perilLocator":"3e098176-a700-49cc-b196-7f1c8e435b73","policyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premium":"30.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"createdTimestamp":"1694813725378","displayId":"100017504","exposureLocator":"ce9d8ae2-3f3b-4aa4-aca7-22ada0463b22","locator":"3e098176-a700-49cc-b196-7f1c8e435b73","name":"personal_electronics_blanket","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","renewalGroup":"3e098176-a700-49cc-b196-7f1c8e435b73","updatedTimestamp":"1694813756134"},{"characteristics":[{"coverageEndTimestamp":"1726358399999","coverageStartTimestamp":"1694736000000","createdTimestamp":"1694813725378","exposureCharacteristicsLocator":"3cbfbb94-39a6-4e30-aca4-67dd0efa940d","fieldGroupsByLocator":{},"fieldValues":{},"locator":"385587f8-da5c-46c3-9348-b079ebdfbb96","mediaByLocator":{},"monthPremium":"2.4166667","perilLocator":"123f1878-6e5c-4819-a840-85939856e778","policyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premium":"29.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"createdTimestamp":"1694813725378","displayId":"100017506","exposureLocator":"ce9d8ae2-3f3b-4aa4-aca7-22ada0463b22","locator":"123f1878-6e5c-4819-a840-85939856e778","name":"replacement_cost","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","renewalGroup":"123f1878-6e5c-4819-a840-85939856e778","updatedTimestamp":"1694813725378"}],"policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813756134"}],"fees":[],"grossFees":"0.00","invoices":[],"locator":"100017366","modifications":[{"automatedUnderwritingResult":{"decision":"accept","decisionTimestamp":"1694813759579","notes":[]},"configVersion":"34","createdTimestamp":"1694813273079","displayId":"100017370","effectiveTimestamp":"1694736000000","exposureModifications":[{"exposureLocator":"751eeff0-3119-4872-895e-8aef55a298bd","locator":"5a707742-cc8f-426f-b59d-8b646f87248c","newExposureCharacteristicsLocator":"b4b7b328-883b-4dce-80b6-b3bda00f5f24","perilModifications":[{"exposureModificationLocator":"5a707742-cc8f-426f-b59d-8b646f87248c","locator":"28672d93-5b24-45dc-b9db-4496fe9d03ae","newPerilCharacteristicsLocator":"fa96934f-5694-4e47-bd7b-811b6c426e2f","perilLocator":"040ddac6-7d66-4a5d-ad9c-97d982e1f06e","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"-3.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"},{"exposureModificationLocator":"5a707742-cc8f-426f-b59d-8b646f87248c","locator":"ecea8b3b-0c37-4722-a321-0706c0d8629d","newPerilCharacteristicsLocator":"ef97c585-f307-4414-ac51-714ea911b315","perilLocator":"af693279-3e7e-49e1-b689-ec7b258ac208","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"14.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"},{"exposureModificationLocator":"5a707742-cc8f-426f-b59d-8b646f87248c","locator":"3d5b27c1-70b1-49c6-bd05-f407992b25fa","newPerilCharacteristicsLocator":"7c5953a0-b2ce-48c6-af39-cc750263946d","perilLocator":"9ccccf5f-e6cf-433c-bbb0-d9091140c0d3","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"8.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"}],"policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"},{"exposureLocator":"4fff9ab6-3df2-45ca-840c-6bcf56fbd4b1","locator":"52ed9ede-1e8e-43ec-8006-10ed9261a1b8","newExposureCharacteristicsLocator":"6f0680d9-951e-4621-9f4a-1351df758fa3","perilModifications":[{"exposureModificationLocator":"52ed9ede-1e8e-43ec-8006-10ed9261a1b8","locator":"e5d9c117-e9d1-4928-9300-f0e4975a9952","newPerilCharacteristicsLocator":"af6d7253-3bbb-460e-9d6a-536dd4365fc8","perilLocator":"e689bc6d-025b-42e3-bb6d-55ac3c78e207","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"84.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"},{"exposureModificationLocator":"52ed9ede-1e8e-43ec-8006-10ed9261a1b8","locator":"01474145-2ebd-4631-afdc-d08560ffb621","newPerilCharacteristicsLocator":"eb4fcd8b-2042-476a-916e-1a4f6ebf5e66","perilLocator":"166dfe3c-a789-4d76-854f-6e905e2f9999","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"0.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"}],"policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"},{"exposureLocator":"ce9d8ae2-3f3b-4aa4-aca7-22ada0463b22","locator":"8bc2ce8f-e016-4d06-87d6-5d5bd0f805cd","newExposureCharacteristicsLocator":"3cbfbb94-39a6-4e30-aca4-67dd0efa940d","perilModifications":[{"exposureModificationLocator":"8bc2ce8f-e016-4d06-87d6-5d5bd0f805cd","locator":"609c79ec-5885-41fa-a851-925ecf15d756","newPerilCharacteristicsLocator":"d94c9c30-89b4-4653-ad45-ca094ca11b41","perilLocator":"14ed2b8d-43eb-4c6f-911f-53dff56c7f8a","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"12.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"},{"exposureModificationLocator":"8bc2ce8f-e016-4d06-87d6-5d5bd0f805cd","locator":"bb142372-5eed-48d4-a9df-b91a9fc9608f","newPerilCharacteristicsLocator":"3fd237c9-f094-45f6-9c14-8a1c15758f61","perilLocator":"3e098176-a700-49cc-b196-7f1c8e435b73","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"30.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"},{"exposureModificationLocator":"8bc2ce8f-e016-4d06-87d6-5d5bd0f805cd","locator":"d0c1bde8-29e5-4954-a384-6292b9eb0db8","newPerilCharacteristicsLocator":"385587f8-da5c-46c3-9348-b079ebdfbb96","perilLocator":"123f1878-6e5c-4819-a840-85939856e778","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"29.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"}],"policyLocator":"100017368","policyModificationLocator":"c17521a5-307a-4fa0-8960-4643a56d97d4","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf"}],"fieldGroupsByLocator":{},"fieldValues":{},"locator":"c17521a5-307a-4fa0-8960-4643a56d97d4","mediaByLocator":{},"name":"modification.policy.create","newPolicyCharacteristicsLocator":"65b6217e-f633-4490-84c1-bdd097a5a813","newPolicyCharacteristicsLocators":["65b6217e-f633-4490-84c1-bdd097a5a813"],"number":"0","policyLocator":"100017368","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","premiumChange":"174.00","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","updatedTimestamp":"1694813759579"}],"originalContractEndTimestamp":"1726358399999","originalContractStartTimestamp":"1694736000000","paymentScheduleName":"monthly","policyholderLocator":"301e2ec1-d412-4d1e-a647-cb332e07b7f0","productLocator":"11ee-24d3-297d704f-9bea-6927740151bf","productName":"Protect","quoteSummary":{"notDiscarded":[{"locator":"100017372","name":"1","state":"draft"}],"selected":"100017372"},"updatedTimestamp":"1694813759579"},"productName":"Protect","tenantTimeZone":"UTC","transactionType":"newBusiness"}');
// global.debug = true;
// const payload = JSON.parse('{"charges":[{"amount":"-1800.00","amountCurrency":"USD","category":"new","chargeId":"1_premium_520f6f25-c791-4e27-8bf4-20638f4d9a6a","coverageEndTimestamp":"1728691199999","coverageStartTimestamp":"1697068800000","isNew":true,"originalAmount":"-1800.00","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilLocator":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","perilName":"base_premium","policyModificationLocator":"dbcad84a-7911-4b86-8c7d-ff4a0065e57e","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"90.00","amountCurrency":"USD","category":"new","chargeId":"2_premium_21877b86-3629-444e-ba9e-e79a3f91bc62","coverageEndTimestamp":"1728691199999","coverageStartTimestamp":"1697068800000","isNew":true,"originalAmount":"90.00","perilCharacteristicsLocator":"21877b86-3629-444e-ba9e-e79a3f91bc62","perilLocator":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","perilName":"base_premium","policyModificationLocator":"dbcad84a-7911-4b86-8c7d-ff4a0065e57e","previouslyInvoicedAmount":"0","type":"premium"},{"amount":"1650.00","amountCurrency":"USD","category":"previously_invoiced","chargeId":"3_premium_520f6f25-c791-4e27-8bf4-20638f4d9a6a","coverageEndTimestamp":"1728691199999","coverageStartTimestamp":"1699747200000","isNew":false,"originalAmount":"1800.00","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilLocator":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","previouslyInvoicedAmount":"150.00","type":"premium"}],"coverageEndTimestamp":"1728691199999","coverageStartTimestamp":"1697068800000","defaultPaymentTerms":{"amount":"2","unit":"day"},"oldPaymentScheduleName":"monthly","operation":"endorsement","paymentScheduleName":"monthly","plannedInvoices":[{"dueTimestamp":"1699833599999","endTimestamp":"1702339199999","financialTransactions":[{"amount":"150.00","endTimestamp":"1702339199999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1699747200000","type":"premium"},{"amount":"2.00","endTimestamp":"1702339199999","feeLocator":"54f8d9e9-f603-494b-9a86-ef25985d3420","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1699574400000","startTimestamp":"1699747200000","type":"fee"}],"issueTimestamp":"1699574400000","startTimestamp":"1699747200000","writeOff":false},{"dueTimestamp":"1702425599999","endTimestamp":"1705017599999","financialTransactions":[{"amount":"150.00","endTimestamp":"1705017599999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1702339200000","type":"premium"},{"amount":"2.00","endTimestamp":"1705017599999","feeLocator":"a59f9ac6-7aa8-4603-9fa5-5c96282fc500","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1702166400000","startTimestamp":"1702339200000","type":"fee"}],"issueTimestamp":"1702166400000","startTimestamp":"1702339200000","writeOff":false},{"dueTimestamp":"1705103999999","endTimestamp":"1707695999999","financialTransactions":[{"amount":"150.00","endTimestamp":"1707695999999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1705017600000","type":"premium"},{"amount":"2.00","endTimestamp":"1707695999999","feeLocator":"7edad0f9-9126-45e3-9f46-58cd2de09f02","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1704844800000","startTimestamp":"1705017600000","type":"fee"}],"issueTimestamp":"1704844800000","startTimestamp":"1705017600000","writeOff":false},{"dueTimestamp":"1707782399999","endTimestamp":"1710201599999","financialTransactions":[{"amount":"150.00","endTimestamp":"1710201599999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1707696000000","type":"premium"},{"amount":"2.00","endTimestamp":"1710201599999","feeLocator":"b13b637c-3729-4f80-9363-5ce9131b4fc9","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1707523200000","startTimestamp":"1707696000000","type":"fee"}],"issueTimestamp":"1707523200000","startTimestamp":"1707696000000","writeOff":false},{"dueTimestamp":"1710287999999","endTimestamp":"1712879999999","financialTransactions":[{"amount":"150.00","endTimestamp":"1712879999999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1710201600000","type":"premium"},{"amount":"2.00","endTimestamp":"1712879999999","feeLocator":"dc7d2391-b990-4ef5-8f0a-82a5ca18a16c","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1710028800000","startTimestamp":"1710201600000","type":"fee"}],"issueTimestamp":"1710028800000","startTimestamp":"1710201600000","writeOff":false},{"dueTimestamp":"1712966399999","endTimestamp":"1715471999999","financialTransactions":[{"amount":"150.00","endTimestamp":"1715471999999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1712880000000","type":"premium"},{"amount":"2.00","endTimestamp":"1715471999999","feeLocator":"cf7d0c8c-ec7d-4590-b97c-bd1660222b17","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1712707200000","startTimestamp":"1712880000000","type":"fee"}],"issueTimestamp":"1712707200000","startTimestamp":"1712880000000","writeOff":false},{"dueTimestamp":"1715558399999","endTimestamp":"1718150399999","financialTransactions":[{"amount":"150.00","endTimestamp":"1718150399999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1715472000000","type":"premium"},{"amount":"2.00","endTimestamp":"1718150399999","feeLocator":"e03fc9b4-4977-4386-bff3-7ba6308c61de","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1715299200000","startTimestamp":"1715472000000","type":"fee"}],"issueTimestamp":"1715299200000","startTimestamp":"1715472000000","writeOff":false},{"dueTimestamp":"1718236799999","endTimestamp":"1720742399999","financialTransactions":[{"amount":"150.00","endTimestamp":"1720742399999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1718150400000","type":"premium"},{"amount":"2.00","endTimestamp":"1720742399999","feeLocator":"15576f39-ad0e-45e9-b392-b56366039231","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1717977600000","startTimestamp":"1718150400000","type":"fee"}],"issueTimestamp":"1717977600000","startTimestamp":"1718150400000","writeOff":false},{"dueTimestamp":"1720828799999","endTimestamp":"1723420799999","financialTransactions":[{"amount":"150.00","endTimestamp":"1723420799999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1720742400000","type":"premium"},{"amount":"2.00","endTimestamp":"1723420799999","feeLocator":"a53202e8-9438-4a1a-86d1-9ee2c3ca290c","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1720569600000","startTimestamp":"1720742400000","type":"fee"}],"issueTimestamp":"1720569600000","startTimestamp":"1720742400000","writeOff":false},{"dueTimestamp":"1723507199999","endTimestamp":"1726099199999","financialTransactions":[{"amount":"150.00","endTimestamp":"1726099199999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1723420800000","type":"premium"},{"amount":"2.00","endTimestamp":"1726099199999","feeLocator":"3f71d94f-645d-41d0-8a19-2bf86b790940","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1723248000000","startTimestamp":"1723420800000","type":"fee"}],"issueTimestamp":"1723248000000","startTimestamp":"1723420800000","writeOff":false},{"dueTimestamp":"1726185599999","endTimestamp":"1728691199999","financialTransactions":[{"amount":"150.00","endTimestamp":"1728691199999","perilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilName":"base_premium","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1697133071158","startTimestamp":"1726099200000","type":"premium"},{"amount":"2.00","endTimestamp":"1728691199999","feeLocator":"cf9e8849-9438-4e33-9366-d6857765dac6","feeName":"installment_fee","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","postedTimestamp":"1725926400000","startTimestamp":"1726099200000","type":"fee"}],"issueTimestamp":"1725926400000","startTimestamp":"1726099200000","writeOff":false}],"policy":{"characteristics":[{"createdTimestamp":"1697132968654","endTimestamp":"1728691199999","fieldGroupsByLocator":{"7222510d-c4f9-49d8-8463-a7cae810f894":{"addl_interest_name":["XMH"]},"d91418f0-5067-48ba-8b29-dfb91f7253e5":{"address_city":["Raleigh"],"address_line_1":["1101 Gorman Street"],"address_state":["NC"],"address_zip":["27606"],"building_id":["32a3134a90e84ae08456e1596a7d207b"]}},"fieldValues":{"addl_interests":["7222510d-c4f9-49d8-8463-a7cae810f894"],"auto_renewal_status":["renew"],"building_details":["d91418f0-5067-48ba-8b29-dfb91f7253e5"],"credit_score":["600"],"custom_policy_number":["JTY-2023-1012J3W4PK"],"policy_term":["1"]},"grossPremium":"1800.00","grossTaxes":"0.00","issuedTimestamp":"1697133096107","locator":"0c2bf786-e378-40c5-bfa0-aa0ea44e32a6","mediaByLocator":{},"policyEndTimestamp":"1728691199999","policyLocator":"104387114","policyStartTimestamp":"1697068800000","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","replacedTimestamp":"1697133232377","startTimestamp":"1697068800000","taxGroups":[],"updatedTimestamp":"1697133096107"},{"createdTimestamp":"1697133232377","endTimestamp":"1728691199999","fieldGroupsByLocator":{"7222510d-c4f9-49d8-8463-a7cae810f894":{"addl_interest_name":["XMH"]},"d91418f0-5067-48ba-8b29-dfb91f7253e5":{"address_city":["Raleigh"],"address_line_1":["1101 Gorman Street"],"address_state":["NC"],"address_zip":["27606"],"building_id":["32a3134a90e84ae08456e1596a7d207b"]}},"fieldValues":{"addl_interests":["7222510d-c4f9-49d8-8463-a7cae810f894"],"auto_renewal_status":["renew"],"building_details":["d91418f0-5067-48ba-8b29-dfb91f7253e5"],"credit_score":["600"],"custom_policy_number":["JTY-2023-1012J3W4PK"],"policy_term":["1.1"]},"grossPremium":"90.00","grossTaxes":"0.00","issuedTimestamp":"1697133232377","locator":"9b56c2d2-89f6-45d2-be8e-dee218730bff","mediaByLocator":{},"policyEndTimestamp":"1728691199999","policyLocator":"104387114","policyStartTimestamp":"1697068800000","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","startTimestamp":"1697068800000","taxGroups":[],"updatedTimestamp":"1697133232377"}],"configVersion":"31","createdTimestamp":"1697131386156","currency":"USD","displayId":"104387114","documents":[{"createdTimestamp":"1697133096107","displayName":"Invoice","fileName":"invoice.pdf","locator":"3c8f6a67-ee31-499c-b788-b5e0ac3b13c5","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","type":"pdf","url":"https://storage-jetty.socotra.com/socotra-document-fs4rmdzu/s3/us-east-1/amazonaws/com/eb3ae839-1316-426d-bc5e-4a93d6598c6f/d2745e0e-4e42-4395-862b-dda5fb03528f/document.original?response-content-disposition=attachment%3B%20filename%3D%22invoice.pdf%22&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20231012T175352Z&X-Amz-SignedHeaders=host&X-Amz-Expires=1800&X-Amz-Credential=AKIA2AJ5JHEKX5MJILV6%2F20231012%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=44dba7ffcc6e11ebb729cd880d68d338b335e05365b56c1c9f49d205aee85c3b","urlExpirationTimestamp":"1697135032425"}],"effectiveContractEndTimestamp":"1728691199999","exposures":[{"characteristics":[{"createdTimestamp":"1697132968654","endTimestamp":"1728691199999","exposureLocator":"63de032b-2f7b-4993-bc8d-0b4703820031","fieldGroupsByLocator":{},"fieldValues":{"bond_amount":["10000"]},"issuedTimestamp":"1697133096107","locator":"f8e9cdcf-2046-46b9-80e0-ef9c2adb6c93","mediaByLocator":{},"policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","replacedTimestamp":"1697133232377","startTimestamp":"1697068800000","updatedTimestamp":"1697133096107"},{"createdTimestamp":"1697133232377","endTimestamp":"1728691199999","exposureLocator":"63de032b-2f7b-4993-bc8d-0b4703820031","fieldGroupsByLocator":{},"fieldValues":{"bond_amount":["500"]},"issuedTimestamp":"1697133232377","locator":"ac22ecef-a918-4dfb-9174-b01f62e49c7f","mediaByLocator":{},"policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","startTimestamp":"1697068800000","updatedTimestamp":"1697133232377"}],"createdTimestamp":"1697132968654","displayId":"104387482","locator":"63de032b-2f7b-4993-bc8d-0b4703820031","name":"bond","perils":[{"characteristics":[{"coverageEndTimestamp":"1728691199999","coverageStartTimestamp":"1697068800000","createdTimestamp":"1697132968654","exposureCharacteristicsLocator":"f8e9cdcf-2046-46b9-80e0-ef9c2adb6c93","fieldGroupsByLocator":{},"fieldValues":{},"issuedTimestamp":"1697133096107","locator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","mediaByLocator":{},"monthPremium":"150.0000","perilLocator":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","policyCharacteristicsLocator":"0c2bf786-e378-40c5-bfa0-aa0ea44e32a6","policyLocator":"104387114","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","premium":"1800.00","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","replacedTimestamp":"1697133232377","updatedTimestamp":"1697133096107"},{"coverageEndTimestamp":"1728691199999","coverageStartTimestamp":"1697068800000","createdTimestamp":"1697133232377","exposureCharacteristicsLocator":"ac22ecef-a918-4dfb-9174-b01f62e49c7f","fieldGroupsByLocator":{},"fieldValues":{},"issuedTimestamp":"1697133232377","locator":"21877b86-3629-444e-ba9e-e79a3f91bc62","mediaByLocator":{},"monthPremium":"7.5000000","perilLocator":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","policyCharacteristicsLocator":"9b56c2d2-89f6-45d2-be8e-dee218730bff","policyLocator":"104387114","policyModificationLocator":"dbcad84a-7911-4b86-8c7d-ff4a0065e57e","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","premium":"90.00","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","updatedTimestamp":"1697133232377"}],"createdTimestamp":"1697132968654","displayId":"104387484","exposureLocator":"63de032b-2f7b-4993-bc8d-0b4703820031","locator":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","name":"base_premium","policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","renewalGroup":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","updatedTimestamp":"1697133232377"}],"policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","updatedTimestamp":"1697133232377"}],"fees":[{"amount":"2.00","description":"Fee for payments over time","endTimestamp":"1699747199999","locator":"b35cfc29-062e-49e0-b4c2-f6878aee8162","name":"installment_fee","reversed":false,"startTimestamp":"1697068800000"}],"grossFees":"2.00","invoices":[{"createdTimestamp":"1697133085564","displayId":"104387488","documents":[{"createdTimestamp":"1697133085564","displayName":"invoice_104387488.pdf","fileName":"invoice_104387488.pdf","locator":"ddcb16ad-7ed6-4116-9e3f-b57328579307","type":"pdf","url":"https://storage-jetty.socotra.com/socotra-document-fs4rmdzu/s3/us-east-1/amazonaws/com/eb3ae839-1316-426d-bc5e-4a93d6598c6f/5260c6b1-656d-4aa3-81e8-42b47f1fd6f9/document.original?response-content-disposition=attachment%3B%20filename%3D%22invoice_104387488.pdf%22&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20231012T175352Z&X-Amz-SignedHeaders=host&X-Amz-Expires=1800&X-Amz-Credential=AKIA2AJ5JHEKX5MJILV6%2F20231012%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=a4043bd0b800c53693e5080a7330afc1e07e3135b8be3f558655edeb1ccb58cb","urlExpirationTimestamp":"1697135032425"}],"dueTimestamp":"1697155199999","endTimestamp":"1699747199999","invoiceType":"newBusiness","locator":"5c978458-a438-438d-a777-4ead81612996","payments":[{"amount":"152.00","amountCurrency":"USD","createdTimestamp":"1697133189357","displayId":"104387384","fieldValues":{"stripe_payment_id":["pi_152"],"stripe_source_id":["src_1Nfr2qFMQ9Kebg3joUHMjX9W"]},"invoiceLocator":"5c978458-a438-438d-a777-4ead81612996","locator":"b0fdeae9-f80f-4d8c-a54a-2d5a956b0dec","mediaByLocator":{},"policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","postedTimestamp":"1697133189357","state":"posted","updatedTimestamp":"1697133189357"}],"policyLocator":"104387114","settlementStatus":"settled","settlementType":"paid","startTimestamp":"1697068800000","statuses":[{"status":"paid","timestamp":"1697133189357"},{"status":"unfulfilled","timestamp":"1697133085564"}],"totalDue":"152.00","totalDueCurrency":"USD","transactionIssued":true,"updatedTimestamp":"1697133189357"}],"issuedTimestamp":"1697133096107","locator":"104387114","modifications":[{"automatedUnderwritingResult":{"decision":"accept","decisionTimestamp":"1697133071158","notes":[]},"configVersion":"31","createdTimestamp":"1697132968654","displayId":"104387480","effectiveTimestamp":"1697068800000","exposureModifications":[{"exposureLocator":"63de032b-2f7b-4993-bc8d-0b4703820031","locator":"f91c7d20-8948-4e89-93fc-8b8f75c7c61e","newExposureCharacteristicsLocator":"f8e9cdcf-2046-46b9-80e0-ef9c2adb6c93","perilModifications":[{"exposureModificationLocator":"f91c7d20-8948-4e89-93fc-8b8f75c7c61e","locator":"0526611c-fc29-447c-a08a-17d473d27dea","newPerilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a","perilLocator":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","premiumChange":"1800.00","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4"}],"policyLocator":"104387114","policyModificationLocator":"e87ee336-8b15-41a2-b2e3-73531634e47b","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4"}],"fieldGroupsByLocator":{},"fieldValues":{},"issuedTimestamp":"1697133096107","locator":"e87ee336-8b15-41a2-b2e3-73531634e47b","mediaByLocator":{},"name":"modification.policy.create","newPolicyCharacteristicsLocator":"0c2bf786-e378-40c5-bfa0-aa0ea44e32a6","newPolicyCharacteristicsLocators":["0c2bf786-e378-40c5-bfa0-aa0ea44e32a6"],"number":"0","policyEndTimestamp":"1728691199999","policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","premiumChange":"1800.00","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","updatedTimestamp":"1697133096107"},{"configVersion":"31","createdTimestamp":"1697133232377","displayId":"104387494","effectiveTimestamp":"1697068800000","exposureModifications":[{"exposureLocator":"63de032b-2f7b-4993-bc8d-0b4703820031","locator":"247b3c59-6d18-4cd2-87d0-22e9ea94b949","newExposureCharacteristicsLocator":"ac22ecef-a918-4dfb-9174-b01f62e49c7f","perilModifications":[{"exposureModificationLocator":"247b3c59-6d18-4cd2-87d0-22e9ea94b949","locator":"b8241cc9-88f4-4a80-a977-4c474a06e19b","newPerilCharacteristicsLocator":"21877b86-3629-444e-ba9e-e79a3f91bc62","perilLocator":"8199c4ae-10f4-4ff1-8127-f3e2532c5451","policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","premiumChange":"-1710.00","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","replacedPerilCharacteristicsLocator":"520f6f25-c791-4e27-8bf4-20638f4d9a6a"}],"policyLocator":"104387114","policyModificationLocator":"dbcad84a-7911-4b86-8c7d-ff4a0065e57e","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4"}],"fieldGroupsByLocator":{},"fieldValues":{},"issuedTimestamp":"1697133232377","locator":"dbcad84a-7911-4b86-8c7d-ff4a0065e57e","mediaByLocator":{},"name":"endorsement.with.repricing","newPolicyCharacteristicsLocators":["9b56c2d2-89f6-45d2-be8e-dee218730bff"],"number":"1","policyEndTimestamp":"1728691199999","policyLocator":"104387114","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","premiumChange":"-1710.00","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","updatedTimestamp":"1697133232377"}],"originalContractEndTimestamp":"1728691199999","originalContractStartTimestamp":"1697068800000","paymentScheduleName":"monthly","policyholderLocator":"419b3393-e2a8-454d-bc6a-62ab1935a7fe","productLocator":"11ee-108d-13828cc4-a317-41b358fdc5c4","productName":"Deposit-Dynamic","quoteSummary":{"notDiscarded":[{"locator":"104387124","name":"upfront","state":"quoted"},{"locator":"104387136","name":"monthly","state":"quoted"},{"locator":"104387486","name":"3","state":"accepted"}],"selected":"104387486"},"updatedTimestamp":"1697133232377"},"productName":"Deposit-Dynamic","tenantTimeZone":"UTC","transactionType":"endorsement"}');
// console.log(JSON.stringify(createInstallments(payload)));

function createInstallments(data) {
    console.log(`Installment Plugin - ${data?.policy?.locator}`);
    console.log(JSON.stringify(data));

    // Read test indicator from Aux Data
    let testIndicator;
    let migrationIndicator;
    let migrationTimestamp;
    const dateCalc = new DateCalc(data.tenantTimeZone);

    if (global?.debug) {
        // testIndicator = 'hourly';

        const migrationTimestampString = '1695821883000';
        migrationIndicator = !!'true';
        migrationTimestamp = migrationTimestampString ? parseInt(migrationTimestampString) : undefined;
        migrationIndicator = migrationIndicator || migrationTimestamp && dateCalc.getMidDayTimestamp(migrationTimestamp) > Date.now();
    } else {
        testIndicator = socotraApi.getAuxData(data?.policy?.locator, 'test-indicator');
        console.log('Test indicator: ', testIndicator);

        const migrationTimestampString = socotraApi.getAuxData(data?.policy?.locator, 'migration_brightcore_timestamp');
        migrationIndicator = !!socotraApi.getAuxData(data?.policy?.locator, 'migration_indicator');
        console.log('Migration timestamp: ', migrationTimestampString);
        migrationTimestamp = migrationTimestampString ? parseInt(migrationTimestampString) : undefined;
        migrationIndicator = migrationIndicator || migrationTimestamp && dateCalc.getMidDayTimestamp(migrationTimestamp) > Date.now();
        console.log('Migration indicator: ', migrationIndicator);
    }

    if (!migrationIndicator && data.productName === 'Deposit-Dynamic') {
        if (data.oldPaymentScheduleName === 'upfront' && data.paymentScheduleName === 'monthly') {
            throw new Error(`StartUIerror Plugin Error [Installment]: Changing payment schedule from 'Upfront' to 'Monthly' not alowed for Jetty Deposit. EndUIerror`);
        }

        let paymentScheduleLimitationDuration = 19;
        let paymentScheduleLimitationUnit = 'months';
        let paymentScheduleLimitationErrorDuration = '19 months';
        if (testIndicator) {
            if (testIndicator === 'hourly') {
                paymentScheduleLimitationUnit = 'hours';
                paymentScheduleLimitationErrorDuration = '38 hours';
            } else {
                paymentScheduleLimitationUnit = 'days';
                paymentScheduleLimitationDuration = 12;
                paymentScheduleLimitationErrorDuration = '12 days';
            }
        }

        if (Date.now() >= dateCalc.addToTimestamp(parseInt(data.coverageStartTimestamp), paymentScheduleLimitationDuration, paymentScheduleLimitationUnit)) {
            throw new Error(`StartUIerror Plugin Error [Installment]: Changing payment schedule not allowed for Jetty Deposit after ${paymentScheduleLimitationErrorDuration}. EndUIerror`);
        }
    }

    const options = {
        preventStartAndEndTimestampOverlap: true, // Prevent start and end timestamp overlap
        collapsePastInstallments: false, // Collapse past installments
        feesOnFirstInstallment: true, // Fees should be there on all 12 installments
        installmentPremiumFromAuxData: true, // Get installment premium from aux data
        installmentFeesFromAuxData: true, // Get installment fees from aux data
        distributeCorrectionToLastInstallment: true, // Distribute correction to last installment
        distributionRounding: 'ceil', // Distribution rounding
        distributionRoundingPrecision: 1, // Distribution rounding precision
        preferredPaymentLastDayOfMonth: 28,
        alwaysFullPayCredit: false, // Do not full pay credit on first installment
        alwaysFullPayCancellation: true, // Always full pay cancellation
        ...(testIndicator ? {
            fullPayNowThreshold: 0,
            paymentScheduleToIncrement: testIndicator === 'hourly' ? {
                'upfront': 'eon',
                'annually': '24hour',
                'monthly': '2hour'
            } : {
                'upfront': 'eon',
                'annually': '12day',
                'monthly': 'day'
            },
            defaultPaymentTermsUnit: 'minute',
        } : {}),
        ...(global.debug ? {
            // installmentPremiumWeight: '0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0',
            installmentPremiumWeight: '1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1',
            // installmentPremiumWeight: '1.71, 1.71, 1.71, 1.71, 1.71, 1.71, 1.71, 0, 0, 0, 0, 0',
            // installmentFeeAmount: '0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0',
            installmentFeeAmount: '2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2',
            // preferredPaymentTimestamp: 1698192000000,
            installments: [
                null,
                // '[{"description": "Initial Invoice", "issueTimestamp": 1617792582000, "dueTimestamp": 1622851200000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792582000, "dueTimestamp": 1625443200000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792582000, "dueTimestamp": 1628121600000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792582000, "dueTimestamp": 1630800000000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792583000, "dueTimestamp": 1633392000000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792583000, "dueTimestamp": 1636070400000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792583000, "dueTimestamp": 1638662400000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792583000, "dueTimestamp": 1641340800000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792583000, "dueTimestamp": 1644019200000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792583000, "dueTimestamp": 1646438400000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792583000, "dueTimestamp": 1649116800000, "paidInFull": true, "premium": 6.33, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1617792583000, "dueTimestamp": 1651708800000, "paidInFull": true, "premium": 6.37, "fees": 2.0}]',
                // '[{"description": "Renewal Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1654387200000, "paidInFull": true, "premium": 6.29, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1656979200000, "paidInFull": true, "premium": 6.29, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1659657600000, "paidInFull": true, "premium": 6.29, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1662336000000, "paidInFull": true, "premium": 6.29, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1664928000000, "paidInFull": true, "premium": 6.29, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1667606400000, "paidInFull": true, "premium": 6.29, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1670198400000, "paidInFull": true, "premium": 6.29, "fees": 2.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1672876800000, "paidInFull": true, "premium": 0.0, "fees": 0.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1675555200000, "paidInFull": true, "premium": 0.0, "fees": 0.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1677974400000, "paidInFull": true, "premium": 0.0, "fees": 0.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1680652800000, "paidInFull": true, "premium": 0.0, "fees": 0.0}, {"description": "Installment Invoice", "issueTimestamp": 1653697542000, "dueTimestamp": 1683244800000, "paidInFull": true, "premium": -0.03, "fees": 0.0}]',
                '[{"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1633132800000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1635811200000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Initial Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1635897600000, "paidInFull": true, "premium": 15.08, "fees": 2.12}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1638403200000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1641081600000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1643760000000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1646179200000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1648857600000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1651449600000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1654128000000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1656720000000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1635951508000, "dueTimestamp": 1659398400000, "paidInFull": true, "premium": 15.12, "fees": 2.08}]',
                '[{"description": "Renewal Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1662076800000, "paidInFull": true, "premium": 15.08, "fees": 2.12}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1664668800000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1667347200000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1669939200000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1672617600000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1675296000000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1677715200000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1680393600000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1682985600000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1685664000000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1688256000000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1661388624000, "dueTimestamp": 1690934400000, "paidInFull": true, "premium": 15.12, "fees": 2.08}]',
                '[{"description": "Renewal Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1693612800000, "paidInFull": true, "premium": 15.08, "fees": 2.12}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1696204800000, "paidInFull": true, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1698883200000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1701475200000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1704153600000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1706832000000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1709337600000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1712016000000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1714608000000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1717286400000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1719878400000, "paidInFull": false, "premium": 15.08, "fees": 2.08}, {"description": "Installment Invoice", "issueTimestamp": 1692999069000, "dueTimestamp": 1722556800000, "paidInFull": false, "premium": 15.12, "fees": 2.08}]',
            ],
        } : {}),
    };

    let installmentGenerator = InstallmentsGenerator;
    if (migrationIndicator) {
        installmentGenerator = MigrationInstallmentsGenerator;
        options.distributeCorrectionToFirstInstallment = false;
        options.distributeCorrectionToLastInstallment = false;
    }

    const response = new installmentGenerator(data, options).getInstallments();
    console.log('Installment Response: ', JSON.stringify(response));
    return response;
}

module.exports = {
    createInstallments
}